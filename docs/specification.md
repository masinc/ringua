# Ringua - アプリケーション仕様書

## 1. 概要

Ringuaは複数のAIモデルを活用してクリップボード統合に焦点を当てた高品質な翻訳を提供するデスクトップ翻訳アプリケーションです。このアプリケーションは、最大限のコントロールとプライバシーのために独自のAPIキーを持ち込みたい個人ユーザー向けに設計されています。

## 2. ターゲットユーザー

- **主要**: 信頼性の高い翻訳ツールを求める個人ユーザー
- **副次**: APIベースのソリューションを好む開発者および技術ユーザー
- **ユーザー特性**: 
  - APIキー管理に慣れている
  - 頻繁な翻訳機能が必要
  - プライバシーとローカルデータ保存を重視

## 3. コア機能

### 3.1 クリップボード翻訳
- **説明**: ユーザーがクリップボードから直接コンテンツを翻訳できる主要機能
- **ユーザーフロー**:
  1. ユーザーがテキストをクリップボードにコピー
  2. ユーザーが翻訳をトリガー（ホットキー/ボタン）
  3. 翻訳がアプリケーションに表示
  4. 結果をクリップボードに戻すオプション

### 3.2 マルチモデルAIサポート
- **サポートモデル**:
  - OpenAI GPT (GPT-3.5, GPT-4, GPT-4o)
  - Anthropic Claude (Claude 3 ファミリー)
  - Google Gemini
  - DeepSeek
  - 将来のモデルに対応する拡張可能なアーキテクチャ

### 3.3 翻訳履歴
- **機能**:
  - 翻訳ペアのローカル保存
  - 検索およびフィルタリング機能
  - エクスポート/インポート機能
  - お気に入り/ブックマークシステム

### 3.4 多言語サポート
- **言語検出**: 自動ソース言語検出
- **言語ペア**: 主要な世界言語のサポート
- **ユーザー設定**: デフォルトのソース/ターゲット言語設定

## 4. 技術アーキテクチャ

### 4.1 アプリケーション構造
```
フロントエンド (React + TypeScript)
├── UIコンポーネント
├── 状態管理
├── API統合レイヤー
└── クリップボード統合

バックエンド (Rust + Tauri)
├── データベース管理 (SQLite)
├── AIモデルAPIクライアント
├── システム統合 (クリップボード)
└── 設定管理
```

### 4.2 データフロー
```
ユーザー入力 → クリップボード → フロントエンド → バックエンド → AI API → バックエンド → フロントエンド → 表示
                                                ↓
                                           SQLiteデータベース
```

## 5. ユーザーインターフェース仕様

### 5.1 メインウィンドウ
- **レイアウト**: 2パネル設計（ソース/ターゲット）
- **コンポーネント**:
  - 入力テキストエリア（ソース）
  - 出力テキストエリア（ターゲット）
  - 言語選択ドロップダウン
  - AIモデル選択
  - 翻訳ボタン
  - 履歴サイドバー（折りたたみ可能）

### 5.2 設定ウィンドウ
- **API設定**:
  - 各モデルのAPIキー入力フィールド
  - APIエンドポイント設定
  - 接続テスト
- **言語設定**:
  - デフォルトソース/ターゲット言語
  - 言語検出設定
- **アプリケーション設定**:
  - テーマ選択
  - ホットキー設定
  - 自動保存設定

### 5.3 履歴ビュー
- **機能**:
  - 翻訳の時系列リスト
  - 検索機能
  - 言語ペアによるフィルタリング
  - スター/お気に入りシステム
  - エクスポートオプション

## 6. データ管理

### 6.1 データベーススキーマ (SQLite)

#### 翻訳テーブル
```sql
CREATE TABLE translations (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    source_text TEXT NOT NULL,
    target_text TEXT NOT NULL,
    source_language TEXT NOT NULL,
    target_language TEXT NOT NULL,
    ai_model TEXT NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    is_favorite BOOLEAN DEFAULT FALSE
);
```

#### API設定テーブル
```sql
CREATE TABLE api_configs (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    model_name TEXT UNIQUE NOT NULL,
    api_key TEXT,
    api_endpoint TEXT,
    is_enabled BOOLEAN DEFAULT TRUE,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### ユーザー設定テーブル
```sql
CREATE TABLE user_preferences (
    key TEXT PRIMARY KEY,
    value TEXT,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

### 6.2 データセキュリティ
- OSキーリング/資格情報マネージャーを使用したAPIキーの保存
- 機密データのローカルデータベース暗号化
- クラウド同期なし（プライバシーファーストアプローチ）

## 7. API統合

### 7.1 AIモデル統合パターン
```rust
trait TranslationProvider {
    async fn translate(
        &self,
        text: &str,
        source_lang: &str,
        target_lang: &str,
    ) -> Result<String, TranslationError>;
    
    fn get_supported_languages(&self) -> Vec<Language>;
    fn get_model_name(&self) -> &str;
}
```

### 7.2 エラーハンドリング
- **APIエラー**: レート制限、認証失敗、ネットワーク問題
- **ユーザーフィードバック**: 推奨アクション付きの明確なエラーメッセージ
- **フォールバック**: 失敗時に代替モデルを試す機能

## 8. パフォーマンス要件

### 8.1 応答時間
- **翻訳**: 一般的なテキスト（最大1000文字）で5秒未満
- **UI応答性**: ユーザーインタラクションで100ms未満
- **データベース操作**: 履歴クエリで500ms未満

### 8.2 リソース使用量
- **メモリ**: 通常動作時200MB未満
- **ストレージ**: 履歴検索のための効率的なデータベースインデックス
- **CPU**: 最小限のバックグラウンド処理

## 9. セキュリティ考慮事項

### 9.1 APIキー管理
- OS資格情報マネージャーを使用した安全な保存
- 機密データの平文保存なし
- APIキーのクリア/リセットオプション

### 9.2 データプライバシー
- テレメトリや使用追跡なし
- すべてのデータをローカルに保存
- データ保持に対するユーザーコントロール

## 10. 将来の機能拡張

### 10.1 計画中の機能
- **バッチ翻訳**: 複数のテキストブロックのサポート
- **ファイル翻訳**: ドキュメント翻訳のサポート
- **カスタムプロンプト**: ユーザー定義の翻訳プロンプト
- **プラグインシステム**: サードパーティAIモデル統合

### 10.2 潜在的な統合
- **OCR**: 画像からテキストへの翻訳
- **音声**: 音声からテキストへの翻訳
- **ブラウザ拡張**: ウェブページ翻訳
- **モバイルコンパニオン**: クロスデバイス同期

## 11. 開発フェーズ

### フェーズ1: コア機能
- 基本UI実装
- クリップボード統合
- 単一AIモデルサポート（OpenAI GPT）
- 基本翻訳履歴

### フェーズ2: マルチモデルサポート
- 追加AIモデル統合
- 強化されたエラーハンドリング
- 改善されたUI/UX
- 設定管理

### フェーズ3: 高度な機能
- 履歴内の検索とフィルタリング
- エクスポート/インポート機能
- パフォーマンス最適化
- 仕上げとバグ修正

### フェーズ4: 拡張機能
- カスタムプロンプト
- バッチ翻訳
- 高度な設定オプション
- ドキュメントとチュートリアル